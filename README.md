# NTU canoebot
If you are able to access this repo, you are able to download and host your own canoebot!

---

## Installing
This bot is designed to work on Linux-based systems! E.g. Ubuntu, Arch, WSL.
1. clone this repository using:

`git clone "https://github.com/cruzerngz/NTU_canoebot.git"`

2. Navigate to the repository using:

`cd /path/to/this/repo`

3. Install python dependencies by running the install script:

`bash /.scripts/install.sh`

This script installs the necessary python modules directly on your system (no venv for now), adds bash aliases to start/stop/view logs, and sets up crontabs.

---

## Uninstalling
Navigate to the source directory and run:

`bash ./.scripts/uninstall.sh`

---

## Configuring
Now that the bot has been installed, it needs to be set up to point to all the necessary Google resource IDs in order to function properly.
Navigate to the following directory:

`cd ./.configs && ls -al`

Note the files that contain "template" in them.
These will be the only files that require modification.
Let's go over what needs to be modified for each file.

### botsettings.template.json
This file contains common settings shared between the debug and deployed versions of the bot.
For the most part, this file does not need to be modified.

### botsettings.template.deploy.json
This file contains private parameters (API keys, google sheet IDs)
The example file for reference is `botsettings.template.d.json`.
Create a copy of this file and rename it to `botsettings.template.deploy.json`.
Add the API key for the deployed version of the bot, google forms resource IDs, and set the logging level to "INFO" to show informational logs and above.

### botsettings.template.debug.json
This file also takes reference to `botsettings.template.d.json`.
Follow the same procedure as above, but name the file `botsettings.template.debug.json` instead.
Change the API key to point to a debug version of the bot, and change the log level to "DEBUG".

### Review
Altogether there should now be 3 'template' JSON files inside `./.configs`:
- `botsettings.template.json`
- `botsettings.template.deploy.json`
- `botsettings.template.debug.json`

During startup, these files will be read and merged, creatiing 2 more files:
- `botsettings.json`: Actual deployed configuration file read in by canoebot
- `botsettings.debug.json`: Debug configuration file

Do not modifiy those files, they will change with every startup if any of the template files are modified.

---

## Usage
After running the install script there should be 6 new bash aliases added to your `~/.bash_aliases` file:

1. `canoebotrestart`
2. `canoebotstop`
3. `canoebotlog`
4. `canoebotupdate`
5. `canoebotdeploy`
6. `canoebotdebug`

Aliases 1-3 are pretty self-explainatory.
Alias **#1** is used to start/restart the bot.
Any modifications to code or configs should be reflected on the new startup.
**#3** shows a rolling output of the logs generated by the bot.
This is useful when debugging or tracing back exceptions during runtime.
A log file in `./.scripts/canoebot.log` contains logs from the most recent startup of the bot.

Aliases 4-6 are used when updating the bot.
Note that **#4** pulls directly from this repo (or yours, if you've forked it).
So any buggy code that has not been fixed will be pulled as well.
After running **#4** the bot defaults to debug mode.
To change this, run **#5** to switch to deploy mode.

Updating and configuring can be done while the bot is still running.
To apply any new changes, run **#1**.

